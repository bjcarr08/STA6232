---
title: "Project 1"
author: "Brandy Carr"
format: 
  html:
    self-contained: true
    echo: true
    message: false
    warning: false
    error: true # IMPORTANT NOTE - this makes the file render even if there is an error. it is imperative that you check your .html document *before submission* to make sure that it has all results in it.
editor: source
---

**This week you will be analyzing data from the Jackson Heart Study (JHS). You can find the data on Canvas. For full credit, you must include all code chunks and R output backing up your responses.**

</br>

**0. Import the JHS data; you can download it from Canvas. You need to research how to read a SAS data file into R (hint: look into the `haven` package).**

```{r}
library(tidyverse)
JHS <- haven::read_sas("analysis1.sas7bdat")
DT::datatable(head(JHS, n=10), filter="top") # first 10 rows of data
```

</br>

**1a. Model systolic blood pressure (*sbp*; mmHg) as a function of age (*age*; years), education (*HSgrad*; 0=no, 1=yes), and body mass index (*BMI*; kg/m<sup>2</sup>). Remember to report the resulting model.**

```{r}
# Checked for incomplete/missing cases
summary(JHS %>% select(sbp, age, HSgrad, BMI))
```

```{r}
#| eval: false
JHS1 <- JHS %>% select(sbp, age, HSgrad, BMI) %>% na.omit() # removed incomplete cases
m1 <- glm(sbp ~ ., data=JHS1, family="gaussian")
summary(m1)
```

```{r}
#| echo: false
JHS1 <- JHS %>% select(sbp, age, HSgrad, BMI) %>% na.omit() # removed incomplete cases
m1 <- glm(sbp ~ ., data=JHS1, family="gaussian")
summary(m1)
```

</br>

$$\hat{sbp} = 95.04 + 0.44(age) - 0.84(HSgrad) + 0.24(BMI)$$

</br>

**1b. Construct the 95% confidence intervals for the regression coefficients. Remember to state the resulting confidence intervals.**

```{r}
confint(m1)
```

</br>

- 95% CI for $\beta_{age}$ is (0.39, 0.49)

- 95% CI for $\beta_{HSgrad}$ is (-2.51, 0.83)

- 95% CI for $\beta_{BMI}$ is (0.16, 0.32)

</br>

**1c. Is this a significant regression line? Test at the $\alpha=0.05$ level. Remember to typeset the results.**

```{r}
m0 <- glm(sbp ~ 1, data=JHS1, family="gaussian") # intercept only model
anova(m0, m1, test="F")
```

</br>

**Hypotheses:**

- $H_{0}$ : $\beta_{age} = \beta_{HSgrad} = \beta_{BMI} = 0$

- $H_{1}$ : at least one $\beta_{i} \ne 0$

**Test Statistic:** 

- $F_{0} = 122.13$

**P-Value:** 

- $p < 0.001$

**Rejection Region:** 

- $\alpha = 0.05$

- Reject $H_{0}$ if $p < \alpha$

**Conclusion:** 

- Reject $H_{0}$ 

- There is sufficient evidence to suggest that at least one slope is non-zero.

</br> 

**1d. Which predictors, if any, are significant predictors of systolic blood pressure? Test at the $\alpha=0.05$ level. Remember to typeset the results.**

```{r}
c1 <- data.frame(round(summary(m1)$coeff, 3)) # m1 coefficients rounded to 3 decimal places

colnames(c1)[c(2,4)] <- c("Std.Error", "p.value") # re-named 2 columns

library(formattable)
formattable(
  c1, 
  list(
    t.value = color_tile("#FEFEB0", "#FEFEB0"),
    p.value = color_tile("#CDFFE0", "#CDFFE0")
    )
  )
```

</br>

**Predictor: age**

- Hypotheses:

  - $H_{0}$ : $\beta_{age} = 0$

  - $H_{1}$ : $\beta_{age} \ne 0$

- Test Statistic:

  - $t_{0} = 17.480$

- P-Value:

  - $p < 0.001$

- Rejection Region:

  - Reject $H_{0}$ if $p < \alpha;$ $\alpha = 0.05$

- Conclusion:

  - Reject $H_{0}.$ There is sufficient evidence to suggest that age significantly predicts systolic blood pressure (sbp).

</br> 

**Predictor: HSgrad**

- Hypotheses:

  - $H_{0}$ : $\beta_{HSgrad} = 0$

  - $H_{1}$ : $\beta_{HSgrad} \ne 0$

- Test Statistic:

  - $t_{0} = -0.983$

- P-Value:

  - $p = 0.326$

- Rejection Region:

  - Reject $H_{0}$ if $p < \alpha;$ $\alpha = 0.05$

- Conclusion:

  - Fail to reject $H_{0}.$ There is not sufficient evidence to suggest that High School Graduate (HSgrad) significantly predicts systolic blood pressure (sbp).

</br> 

**Predictor: BMI**

- Hypotheses:

  - $H_{0}$ : $\beta_{BMI} = 0$

  - $H_{1}$ : $\beta_{BMI} \ne 0$

- Test Statistic:

  - $t_{0} = 5.870$

- P-Value:

  - $p < 0.001$

- Rejection Region:

  - Reject $H_{0}$ if $p < \alpha;$ $\alpha = 0.05$

- Conclusion:

  - Reject $H_{0}.$ There is sufficient evidence to suggest that Body Mass Index (BMI) significantly predicts systolic blood pressure (sbp).

</br>
















**1e. Provide brief interpretations for the slopes of the predictors.**

Insert your answer here :)

**1f. Construct an appropriate data visualization to help with explaining the model results. Systolic blood pressure should be on the y-axis, age should be on the x-axis. You choose what lines to create.**

```{r}

```

**1g. How many suspected outliers exist? You must justify your answer statistically.**

```{r}

```

Insert your answer here :) 

**1h. How many suspected influential/leverage points exist? You must justify your answer statistically.**

```{r}

```

Insert your answer here :) 

**1i. Is multicollinearity a problem in this model? You must justify your answer statistically.**

```{r}

```

Insert your answer here :) 

**1k. Assess the assumptions on the linear model. Remember to draw your conclusion with appropriate justification.**

```{r}

```

Insert your answer here :) 

**2a. Model systolic blood pressure (*sbp*; mmHg) as a function of age (*age*; years), education (*HSgrad*; 0=no, 1=yes), and health status as defined by body mass index (*BMI3cat*; 0=poor health, 1=intermediate health, 2=ideal health). Remember to report the resulting model.**

```{r}

```

Insert your answer here :) 

**2b. Construct the 95% confidence intervals for the regression coefficients. Remember to state the resulting confidence intervals.**

```{r}

```

Insert your answer here :) 

**2c. Which predictors, if any, are significant predictors of systolic blood pressure? Test at the $\alpha=0.05$ level. Remember to typeset the results.**

```{r}

```

Insert your answer here :) 

**2d. Provide brief interpretations for the slopes of the predictors.**

Insert your answer here :)

**2e. Construct an appropriate data visualization to help with explaining the model results. Systolic blood pressure should be on the y-axis, age should be on the x-axis. You choose what lines to create.**

```{r}

```

**3. Required for graduate students / extra credit for undergraduate students: Write a paragraph to summarize the above analysis, written such that a non-quantitative person could understand. Include if you recommend using BMI as a continuous variable or a categorical variable. For full credit, you must explain your reasoning.**

Insert your answer here :) 
